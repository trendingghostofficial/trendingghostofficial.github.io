import{a as g}from"./chunk-K6AXLRK5.js";import{I as s,L as u,g as a,j as c,n as l,v as r}from"./chunk-YRNHRO3O.js";var p=class n{heroLogoVisible=new a(!0);heroLogoVisible$=this.heroLogoVisible.asObservable();constructor(){}setHeroLogoVisibility(o){this.heroLogoVisible.next(o)}getHeroLogoVisibility(){return this.heroLogoVisible.value}static \u0275fac=function(e){return new(e||n)};static \u0275prov=s({token:n,factory:n.\u0275fac,providedIn:"root"})};var m=class n{constructor(o){this.http=o;this.detectLanguage(),this.loadIdiomasDisponibles(),this.loadUITranslations(this.getCurrentLanguageSync())}currentLang$=new a("es");idiomasDisponibles$=new a([]);uiTranslations={};translationsLoaded=!1;SUPPORTED_LANGS=["es","en","ja","pt","fr"];DATA_BASE_URL="https://raw.githubusercontent.com/trendingghostofficial/trending-ghost-data/main";detectLanguage(){let e=new URLSearchParams(window.location.search).get("lang");if(e&&this.SUPPORTED_LANGS.includes(e)){this.setLanguage(e);return}let i=localStorage.getItem("preferred_lang");if(i&&this.SUPPORTED_LANGS.includes(i)){this.setLanguage(i);return}let t=navigator.language.split("-")[0];if(this.SUPPORTED_LANGS.includes(t)){this.setLanguage(t);return}this.setLanguage("es")}setLanguage(o){this.SUPPORTED_LANGS.includes(o)||(console.warn(`[i18n] Idioma no soportado: ${o}, usando 'es'`),o="es"),console.log(`[i18n] \u{1F504} Cambiando idioma a: ${o}`),this.currentLang$.next(o),localStorage.setItem("preferred_lang",o),this.loadUITranslations(o);let e=new URL(window.location.href);e.searchParams.set("lang",o),window.history.replaceState({},"",e.toString()),console.log(`[i18n] \u2705 Idioma actualizado: ${o}, URL: ${e.toString()}`)}getCurrentLanguage(){return this.currentLang$.asObservable()}getCurrentLanguageSync(){return this.currentLang$.value}loadIdiomasDisponibles(){let o="assets/i18n/idiomas.json";console.log(`[i18n] \u{1F4C2} Cargando idiomas disponibles desde: ${o}`),this.http.get(o).pipe(l(e=>(console.log("[i18n] \u{1F4E6} Datos de idiomas.json recibidos:",e),e.idiomas||[])),r(e=>(console.error("[i18n] \u274C Error cargando idiomas:",e),c([{codigo:"es",nombre_nativo:"Espa\xF1ol",nombre_ingles:"Spanish",emoji:"\u{1F1EA}\u{1F1F8}",icono_emoji:"\u{1F1EA}\u{1F1F8}",activo:!0,es_original:!0,capitulos_traducidos:0,capitulos_totales:0,porcentaje:100},{codigo:"en",nombre_nativo:"English",nombre_ingles:"English",emoji:"\u{1F1EC}\u{1F1E7}",icono_emoji:"\u{1F1EC}\u{1F1E7}",activo:!0,es_original:!1,capitulos_traducidos:0,capitulos_totales:0,porcentaje:0},{codigo:"ja",nombre_nativo:"\u65E5\u672C\u8A9E",nombre_ingles:"Japanese",emoji:"\u{1F1EF}\u{1F1F5}",icono_emoji:"\u{1F1EF}\u{1F1F5}",activo:!0,es_original:!1,capitulos_traducidos:0,capitulos_totales:0,porcentaje:0},{codigo:"pt",nombre_nativo:"Portugu\xEAs",nombre_ingles:"Portuguese",emoji:"\u{1F1E7}\u{1F1F7}",icono_emoji:"\u{1F1E7}\u{1F1F7}",activo:!0,es_original:!1,capitulos_traducidos:0,capitulos_totales:0,porcentaje:0},{codigo:"fr",nombre_nativo:"Fran\xE7ais",nombre_ingles:"French",emoji:"\u{1F1EB}\u{1F1F7}",icono_emoji:"\u{1F1EB}\u{1F1F7}",activo:!0,es_original:!1,capitulos_traducidos:0,capitulos_totales:0,porcentaje:0}])))).subscribe(e=>{console.log("[i18n] \u2705 Idiomas disponibles cargados:",e),this.idiomasDisponibles$.next(e)})}getIdiomasDisponibles(){return this.idiomasDisponibles$.asObservable()}loadChapter(o,e){let i=e||this.getCurrentLanguageSync();return this.tryLoadChapter(o,i).pipe(r(t=>(console.warn(`[i18n] Cap\xEDtulo no disponible en ${i}, intentando fallback`),i!=="en"?this.tryLoadChapter(o,"en").pipe(r(()=>this.tryLoadChapter(o,"es"))):this.tryLoadChapter(o,"es"))))}tryLoadChapter(o,e){let i=e==="es"?`${o}.json`:`${o}.${e}.json`,t=`${this.DATA_BASE_URL}/capitulos/${i}`;return this.http.get(t).pipe(l(d=>(d.idioma=e,d)))}isLanguageAvailable(o,e){return o.idiomas_disponibles?.includes(e)||!1}getLanguageName(o){return this.idiomasDisponibles$.value.find(t=>t.codigo===o)?.nombre_nativo||o.toUpperCase()}getLanguageEmoji(o){return this.idiomasDisponibles$.value.find(t=>t.codigo===o)?.emoji||"\u{1F310}"}needsReview(o){return o.traduccion_info?.necesita_revision||!1}getTranslationMethod(o){let e=o.traduccion_info?.metodo;return{manual:"Traducci\xF3n manual",deepl:"Traducido con DeepL",chatgpt:"Traducido con ChatGPT",community:"Traducci\xF3n comunitaria",unavailable:"Traducci\xF3n no disponible"}[e||"unavailable"]||"Traducci\xF3n autom\xE1tica"}loadUITranslations(o){let e=`assets/i18n/${o}.json`;console.log(`[i18n] \u{1F4C2} Cargando traducciones UI desde: ${e}`),this.http.get(e).pipe(r(i=>(console.error(`[i18n] \u274C Error cargando traducciones UI para ${o}:`,i),o!=="es"?(console.log("[i18n] \u{1F504} Fallback a espa\xF1ol..."),this.http.get("assets/i18n/es.json")):c({})))).subscribe(i=>{this.uiTranslations=i,this.translationsLoaded=!0,console.log(`[i18n] \u2705 Traducciones de UI cargadas: ${o}`,Object.keys(i).length,"claves")})}getTranslation(o){if(!this.translationsLoaded)return console.warn("[i18n] Traducciones a\xFAn no cargadas, retornando key"),o;let e=o.split("."),i=this.uiTranslations;for(let t of e)if(i&&typeof i=="object"&&t in i)i=i[t];else return console.warn(`[i18n] Traducci\xF3n no encontrada: ${o}`),o;return typeof i=="string"?i:o}areTranslationsLoaded(){return this.translationsLoaded}static \u0275fac=function(e){return new(e||n)(u(g))};static \u0275prov=s({token:n,factory:n.\u0275fac,providedIn:"root"})};export{m as a,p as b};
